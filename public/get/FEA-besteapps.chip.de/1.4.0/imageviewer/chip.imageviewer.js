define(["jquery","vendor/core/mediator","jquery-plugins/jquery.fancybox"],function(e,t){"use strict";function n(){return p=e("body"),a=e("#fancybox-wrap"),r=e("#fancybox-outer",a),l=e("#fancybox-close",a),s=e("#fancybox-right span",a),c=e("#fancybox-left span",a),a}function i(){return o(),f.pos(a.data("iActive"))}function o(){return d=e(window).height(),u=e(window).width(),{h:d,w:u}}var a,r,s,c,l,d,u,p,f=e.fancybox;return e.fancybox.init(),{init:function(h){e("a",h).fancybox({titleShow:"false",type:"image",padding:0,margin:0,cyclic:!0,centerOnScroll:!0,overlayOpacity:.85,overlayColor:"#000000",onStart:function(o,r){t.publish("start.imageviewer");var d=null;a||n(),a.data("iActive",r),l.removeClass("fadeIn"),s.removeClass("fadeIn"),c.removeClass("fadeIn"),f.bOpen||(f.bOpen=!0,window.hasOwnProperty("onorientationchange")?e(window).on("orientationchange.fancybox",function(){setTimeout(i,500)}):e(window).on("resize.fancybox",function(){clearTimeout(d),d=setTimeout(i,250)}))},onComplete:function(){var e,t,i,p,f,h,g=10;a&&0!==a.length||n(),d||o(),e=s.width()+g,t=c.width()+g,i=l.height(),p=l.width(),f=d-r.height(),h=u-r.width(),h>e+t?(s.css("right",-1*e+"px"),c.css("left",-1*t+"px")):(s.css("right",g+"px"),c.css("left",g+"px")),h>2*p&&f>2*i?(l.css("top",-1*i+"px"),l.css("right",-1*p+"px")):(l.css("top",g+"px"),l.css("right",g+"px")),l.addClass("fadeIn"),s.addClass("fadeIn"),c.addClass("fadeIn")},onClosed:function(){t.publish("close.imageviewer"),e(window).off("resize.fancybox orientationchange.fancybox"),p.off("dragend"),f.bOpen=!1},onNewPosition:function(){t.publish("pagetracker.imageviewer")}})}}});