define(["jquery"],function(t){(function(e){var i,n,o,a,r,s,d,c,l,h,f,u,p,g=0,m={},y=[],b=0,v={},w=[],x=null,j=new Image,C=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,T=/[^\.]\.(swf)\s*$/i,q=1,I=0,k="",O=!1,A=e.extend(e("<div/>")[0],{prop:0}),z=e.browser.msie&&7>e.browser.version&&!window.XMLHttpRequest,E=function(){n.hide(),j.onerror=j.onload=null,x&&x.abort(),i.empty()},F=function(){return!1===m.onError(y,g,m)?(n.hide(),O=!1,void 0):(m.titleShow=!1,m.width="auto",m.height="auto",i.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),D(),void 0)},S=function(){var t,o,a,r,d,c,l=y[g];if(E(),m=e.extend({},e.fn.fancybox.defaults,e(l).data("fancybox")===void 0?m:e(l).data("fancybox")),c=m.onStart(y,g,m),c===!1)return O=!1,void 0;if("object"==typeof c&&(m=e.extend(m,c)),a=m.title||(l.nodeName?e(l).attr("title"):l.title)||"",l.nodeName&&!m.orig&&(m.orig=e(l).children("img:first").length?e(l).children("img:first"):e(l)),""===a&&m.orig&&m.titleFromAlt&&(a=m.orig.attr("alt")),t=m.href||(l.nodeName?e(l).attr("href"):l.href)||null,(/^(?:javascript)/i.test(t)||"#"==t)&&(t=null),m.type?(o=m.type,t||(t=m.content)):m.content?o="html":t&&(o=t.match(C)?"image":t.match(T)?"swf":e(l).hasClass("iframe")?"iframe":0===t.indexOf("#")?"inline":"ajax"),!o)return F(),void 0;switch("inline"==o&&(l=t.substr(t.indexOf("#")),o=e(l).length>0?"inline":"ajax"),m.type=o,m.href=t,m.title=a,m.autoDimensions&&("html"==m.type||"inline"==m.type||"ajax"==m.type?(m.width="auto",m.height="auto"):m.autoDimensions=!1),m.modal&&(m.overlayShow=!0,m.hideOnOverlayClick=!1,m.hideOnContentClick=!1,m.enableEscapeButton=!1,m.showCloseButton=!1),m.padding=parseInt(m.padding,10),m.margin=parseInt(m.margin,10),i.css("padding",m.padding+m.margin),e(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){e(this).replaceWith(s.children())}),o){case"html":i.html(m.content),D();break;case"inline":if(e(l).parent().is("#fancybox-content")===!0)return O=!1,void 0;e('<div class="fancybox-inline-tmp" />').hide().insertBefore(e(l)).bind("fancybox-cleanup",function(){e(this).replaceWith(s.children())}).bind("fancybox-cancel",function(){e(this).replaceWith(i.children())}),e(l).appendTo(i),D();break;case"image":O=!1,e.fancybox.showActivity(),j=new Image,j.onerror=function(){F()},j.onload=function(){O=!0,j.onerror=j.onload=null,L()},j.src=t;break;case"swf":m.scrolling="no",r='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+m.width+'" height="'+m.height+'"><param name="movie" value="'+t+'"></param>',d="",e.each(m.swf,function(t,e){r+='<param name="'+t+'" value="'+e+'"></param>',d+=" "+t+'="'+e+'"'}),r+='<embed src="'+t+'" type="application/x-shockwave-flash" width="'+m.width+'" height="'+m.height+'"'+d+"></embed></object>",i.html(r),D();break;case"ajax":O=!1,e.fancybox.showActivity(),m.ajax.win=m.ajax.success,x=e.ajax(e.extend({},m.ajax,{url:t,data:m.ajax.data||{},error:function(t){t.status>0&&F()},success:function(e,o,a){var r="object"==typeof a?a:x;if(200==r.status){if("function"==typeof m.ajax.win){if(c=m.ajax.win(t,e,o,a),c===!1)return n.hide(),void 0;("string"==typeof c||"object"==typeof c)&&(e=c)}i.html(e),D()}}}));break;case"iframe":P()}},D=function(){var t=m.width,n=m.height;t=(""+t).indexOf("%")>-1?parseInt((e(window).width()-2*m.margin)*parseFloat(t)/100,10)+"px":"auto"==t?"auto":t+"px",n=(""+n).indexOf("%")>-1?parseInt((e(window).height()-2*m.margin)*parseFloat(n)/100,10)+"px":"auto"==n?"auto":n+"px",i.wrapInner('<div style="width:'+t+";height:"+n+";overflow: "+("auto"==m.scrolling?"auto":"yes"==m.scrolling?"scroll":"hidden")+';position:relative;"></div>'),m.width=i.width(),m.height=i.height(),P()},L=function(){m.width=j.width,m.height=j.height,e("<img />").attr({id:"fancybox-img",src:j.src,alt:m.title}).appendTo(i),P()},P=function(){var t,r;return n.hide(),a.is(":visible")&&!1===v.onCleanup(w,b,v)?(e.event.trigger("fancybox-cancel"),O=!1,void 0):(O=!0,e(s.add(o)).unbind(),e(window).unbind("resize.fb scroll.fb"),e(document).unbind("keydown.fb"),a.is(":visible")&&"outside"!==v.titlePosition&&a.css("height",a.height()),w=y,b=g,v=m,v.overlayShow?(o.css({"background-color":v.overlayColor,opacity:v.overlayOpacity,cursor:v.hideOnOverlayClick?"pointer":"auto",height:e(document).height()}),o.is(":visible")||(z&&e("select:not(#fancybox-tmp select)").filter(function(){return"hidden"!==this.style.visibility}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"}),o.show())):o.hide(),p=W(),X(),a.is(":visible")?(e(d.add(l).add(h)).hide(),t=a.position(),u={top:t.top,left:t.left,width:a.width(),height:a.height()},r=u.width==p.width&&u.height==p.height,s.fadeTo(v.changeFade,.3,function(){var t=function(){s.html(i.contents()).fadeTo(v.changeFade,1,$)};e.event.trigger("fancybox-change"),s.empty().removeAttr("filter").css({"border-width":v.padding,width:p.width-2*v.padding,height:m.autoDimensions?"auto":p.height-I-2*v.padding}),r?t():(A.prop=0,e(A).animate({prop:1},{duration:v.changeSpeed,easing:v.easingChange,step:B,complete:t}))}),void 0):(a.removeAttr("style"),s.css("border-width",v.padding),"elastic"==v.transitionIn?(u=U(),s.html(i.contents()),a.show(),v.opacity&&(p.opacity=0),A.prop=0,e(A).animate({prop:1},{duration:v.speedIn,easing:v.easingIn,step:B,complete:$}),void 0):("inside"==v.titlePosition&&I>0&&c.show(),s.css({width:p.width-2*v.padding,height:m.autoDimensions?"auto":p.height-I-2*v.padding}).html(i.contents()),a.css(p).fadeIn("none"==v.transitionIn?0:v.speedIn,$),void 0)))},N=function(t){return t&&t.length?"float"==v.titlePosition?'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+t+'</td><td id="fancybox-title-float-right"></td></tr></table>':'<div id="fancybox-title-'+v.titlePosition+'">'+t+"</div>":!1},X=function(){if(k=v.title||"",I=0,c.empty().removeAttr("style").removeClass(),v.titleShow===!1)return c.hide(),void 0;if(k=e.isFunction(v.titleFormat)?v.titleFormat(k,w,b,v):N(k),!k||""===k)return c.hide(),void 0;switch(c.addClass("fancybox-title-"+v.titlePosition).html(k).appendTo("body").show(),v.titlePosition){case"inside":c.css({width:p.width-2*v.padding,marginLeft:v.padding,marginRight:v.padding}),I=c.outerHeight(!0),c.appendTo(r),p.height+=I;break;case"over":c.css({marginLeft:v.padding,width:p.width-2*v.padding,bottom:v.padding}).appendTo(r);break;case"float":c.css("left",-1*parseInt((c.width()-p.width-40)/2,10)).appendTo(a);break;default:c.css({width:p.width-2*v.padding,paddingLeft:v.padding,paddingRight:v.padding}).appendTo(a)}c.hide()},M=function(){return(v.enableEscapeButton||v.enableKeyboardNav)&&e(document).bind("keydown.fb",function(t){27==t.keyCode&&v.enableEscapeButton?(t.preventDefault(),e.fancybox.close()):37!=t.keyCode&&39!=t.keyCode||!v.enableKeyboardNav||"INPUT"===t.target.tagName||"TEXTAREA"===t.target.tagName||"SELECT"===t.target.tagName||(t.preventDefault(),e.fancybox[37==t.keyCode?"prev":"next"]())}),v.showNavArrows?((v.cyclic&&w.length>1||0!==b)&&l.show(),(v.cyclic&&w.length>1||b!=w.length-1)&&h.show(),void 0):(l.hide(),h.hide(),void 0)},$=function(){e.support.opacity||(s.get(0).style.removeAttribute("filter"),a.get(0).style.removeAttribute("filter")),m.autoDimensions&&s.css("height","auto"),a.css("height","auto"),k&&k.length&&c.show(),v.showCloseButton&&d.show(),M(),v.hideOnContentClick&&s.bind("click",e.fancybox.close),v.hideOnOverlayClick&&o.bind("click",e.fancybox.close),e(window).bind("resize.fb",e.fancybox.resize),v.centerOnScroll&&e(window).bind("scroll.fb",e.fancybox.center),"iframe"==v.type&&e('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" '+(e.browser.msie?'allowtransparency="true""':"")+' scrolling="'+m.scrolling+'" src="'+v.href+'"></iframe>').appendTo(s),a.show(),O=!1,e.fancybox.center(),v.onComplete(w,b,v),H()},H=function(){var t,e;w.length-1>b&&(t=w[b+1].href,t!==void 0&&t.match(C)&&(e=new Image,e.src=t)),b>0&&(t=w[b-1].href,t!==void 0&&t.match(C)&&(e=new Image,e.src=t))},B=function(t){var e={width:parseInt(u.width+(p.width-u.width)*t,10),height:parseInt(u.height+(p.height-u.height)*t,10),top:parseInt(u.top+(p.top-u.top)*t,10),left:parseInt(u.left+(p.left-u.left)*t,10)};p.opacity!==void 0&&(e.opacity=.5>t?.5:t),a.css(e),s.css({width:e.width-2*v.padding,height:e.height-I*t-2*v.padding})},Y=function(){return[e(window).width()-2*v.margin,e(window).height()-2*v.margin,e(document).scrollLeft()+v.margin,e(document).scrollTop()+v.margin]},W=function(){var t,e=Y(),i={},n=v.autoScale,o=2*v.padding;return i.width=(""+v.width).indexOf("%")>-1?parseInt(e[0]*parseFloat(v.width)/100,10):v.width+o,i.height=(""+v.height).indexOf("%")>-1?parseInt(e[1]*parseFloat(v.height)/100,10):v.height+o,n&&(i.width>e[0]||i.height>e[1])&&("image"==m.type||"swf"==m.type?(t=v.width/v.height,i.width>e[0]&&(i.width=e[0],i.height=parseInt((i.width-o)/t+o,10)),i.height>e[1]&&(i.height=e[1],i.width=parseInt((i.height-o)*t+o,10))):(i.width=Math.min(i.width,e[0]),i.height=Math.min(i.height,e[1]))),i.top=parseInt(Math.max(e[3]-20,e[3]+.5*(e[1]-i.height-40)),10),i.left=parseInt(Math.max(e[2]-20,e[2]+.5*(e[0]-i.width-40)),10),i},R=function(t){var e=t.offset();return e.top+=parseInt(t.css("paddingTop"),10)||0,e.left+=parseInt(t.css("paddingLeft"),10)||0,e.top+=parseInt(t.css("border-top-width"),10)||0,e.left+=parseInt(t.css("border-left-width"),10)||0,e.width=t.width(),e.height=t.height(),e},U=function(){var t,i,n=m.orig?e(m.orig):!1,o={};return n&&n.length?(t=R(n),o={width:t.width+2*v.padding,height:t.height+2*v.padding,top:t.top-v.padding-20,left:t.left-v.padding-20}):(i=Y(),o={width:2*v.padding,height:2*v.padding,top:parseInt(i[3]+.5*i[1],10),left:parseInt(i[2]+.5*i[0],10)}),o},_=function(){return n.is(":visible")?(e("div",n).css("top",-40*q+"px"),q=(q+1)%12,void 0):(clearInterval(f),void 0)};e.fn.fancybox=function(t){return e(this).length?(e(this).data("fancybox",e.extend({},t,e.metadata?e(this).metadata():{})).unbind("click.fb").bind("click.fb",function(t){if(t.preventDefault(),!O){O=!0,e(this).blur(),y=[],g=0;var i=e(this).attr("rel")||"";i&&""!=i&&"nofollow"!==i?(y=e("a[rel="+i+"], area[rel="+i+"]"),g=y.index(this)):y.push(this),S()}}),this):this},e.fancybox=function(i){var n;if(!O){if(O=!0,n=arguments[1]!==void 0?arguments[1]:{},y=[],g=parseInt(n.index,10)||0,e.isArray(i)){for(var o=0,a=i.length;a>o;o++)"object"==typeof i[o]?e(i[o]).data("fancybox",e.extend({},n,i[o])):i[o]=e({}).data("fancybox",e.extend({content:i[o]},n));y=t.merge(y,i)}else"object"==typeof i?e(i).data("fancybox",e.extend({},n,i)):i=e({}).data("fancybox",e.extend({content:i},n)),y.push(i);(g>y.length||0>g)&&(g=0),S()}},e.fancybox.showActivity=function(){clearInterval(f),n.show(),f=setInterval(_,66)},e.fancybox.hideActivity=function(){n.hide()},e.fancybox.next=function(){return m.onNext(b+1),e.fancybox.pos(b+1)},e.fancybox.prev=function(){return m.onPrev(b+1),e.fancybox.pos(b-1)},e.fancybox.pos=function(t){O||(t=parseInt(t),y=w,t>-1&&w.length>t?(g=t,S()):v.cyclic&&w.length>1&&(g=t>=w.length?0:w.length-1,S()),m.onNewPosition(g))},e.fancybox.cancel=function(){O||(O=!0,e.event.trigger("fancybox-cancel"),E(),m.onCancel(y,g,m),O=!1)},e.fancybox.close=function(){function t(){o.fadeOut("fast"),c.empty().hide(),a.hide(),e.event.trigger("fancybox-cleanup"),s.empty(),v.onClosed(w,b,v),w=m=[],b=g=0,v=m={},O=!1}if(!O&&!a.is(":hidden")){if(O=!0,v&&!1===v.onCleanup(w,b,v))return O=!1,void 0;if(E(),e(d.add(l).add(h)).hide(),e(s.add(o)).unbind(),e(window).unbind("resize.fb scroll.fb"),e(document).unbind("keydown.fb"),s.find("iframe").attr("src",z&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank"),"inside"!==v.titlePosition&&c.empty(),a.stop(),"elastic"==v.transitionOut){u=U();var i=a.position();p={top:i.top,left:i.left,width:a.width(),height:a.height()},v.opacity&&(p.opacity=1),c.empty().hide(),A.prop=1,e(A).animate({prop:0},{duration:v.speedOut,easing:v.easingOut,step:B,complete:t})}else a.fadeOut("none"==v.transitionOut?0:v.speedOut,t)}},e.fancybox.resize=function(){o.is(":visible")&&o.css("height",e(document).height()),e.fancybox.center(!0)},e.fancybox.center=function(){var t,e;O||(e=arguments[0]===!0?1:0,t=Y(),(e||!(a.width()>t[0]||a.height()>t[1]))&&a.stop().animate({top:parseInt(Math.max(t[3]-20,t[3]+.5*(t[1]-s.height()-40)-v.padding)),left:parseInt(Math.max(t[2]-20,t[2]+.5*(t[0]-s.width()-40)-v.padding))},"number"==typeof arguments[0]?arguments[0]:200))},e.fancybox.init=function(){e("#fancybox-wrap").length||(e("body").append(i=e('<div id="fancybox-tmp"></div>'),n=e('<div id="fancybox-loading"><div></div></div>'),o=e('<div id="fancybox-overlay"></div>'),a=e('<div id="fancybox-wrap"></div>')),r=e('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(a),r.append(s=e('<div id="fancybox-content"></div>'),d=e('<a id="fancybox-close"></a>'),c=e('<div id="fancybox-title"></div>'),l=e('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),h=e('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>')),d.click(e.fancybox.close),n.click(e.fancybox.cancel),l.click(function(t){t.preventDefault(),e.fancybox.prev()}),h.click(function(t){t.preventDefault(),e.fancybox.next()}),e.fn.mousewheel&&a.bind("mousewheel.fb",function(t,i){O?t.preventDefault():(0==e(t.target).get(0).clientHeight||e(t.target).get(0).scrollHeight===e(t.target).get(0).clientHeight)&&(t.preventDefault(),e.fancybox[i>0?"prev":"next"]())}),e.support.opacity||a.addClass("fancybox-ie"),z&&(n.addClass("fancybox-ie6"),a.addClass("fancybox-ie6"),e('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(r)))},e.fn.fancybox.defaults={padding:10,margin:40,opacity:!1,modal:!1,cyclic:!1,scrolling:"auto",width:560,height:340,autoScale:!0,autoDimensions:!0,centerOnScroll:!1,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:!0,hideOnContentClick:!1,overlayShow:!0,overlayOpacity:.7,overlayColor:"#777",titleShow:!0,titlePosition:"float",titleFormat:null,titleFromAlt:!1,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:!0,showNavArrows:!0,enableEscapeButton:!0,enableKeyboardNav:!0,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){},onNext:function(){},onPrev:function(){},onNewPosition:function(){}},e(document).ready(function(){e.fancybox.init()})})(t)});