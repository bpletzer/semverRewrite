describe("ConsoleReporter",function(){function e(e,t){for(var n=[],i=0;t>i;i++)n.push(e);return n}function t(e,t,n,i,s,r){e.reportRunnerStarting();for(var a=0;t.length>a;a++)e.reportSpecResults(t[a]);for(a=0;n.length>a;a++)e.reportSuiteResults(n[a]);e.runnerStartTime=s,e.now=function(){return r},e.reportRunnerResults(i)}var n,i,s,r="\n",a={results:function(){return{passed:function(){return!0}}}},o={results:function(){return{passed:function(){return!1}}}},c={results:function(){return{skipped:!0}}},u={specs:function(){return[null,null,null]},results:function(){return{failedCount:0,items_:[null,null,null]}}},l={specs:function(){return[null,null,null]},results:function(){return{failedCount:7,items_:[null,null,null]}}};beforeEach(function(){i=function(){var e="";return{print:function(t){e+=t},getOutput:function(){return e},clear:function(){e=""}}}(),s=!1,n=new jasmine.ConsoleReporter(i.print,function(){s=!0})}),describe("Integration",function(){it("prints the proper output under a pass scenario - small numbers.",function(){t(n,e(a,3),[],{specs:function(){return[null,null,null]},results:function(){return{items_:[null,null,null],totalCount:7,failedCount:0}}},1e3,1777);var s=i.getOutput();expect(s).toMatch(/^Started/),expect(s).toMatch(/\.\.\./),expect(s).toMatch(/3 specs, 0 failures/)}),it("prints the proper output under a pass scenario.  large numbers.",function(){t(n,e(a,57),[],{specs:function(){return[null,null,null]},results:function(){return{items_:[null,null,null],totalCount:7,failedCount:0}}},1e3,1777);var s=i.getOutput();expect(s).toMatch(/^Started/),expect(s).toMatch(/\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\./),expect(s).toMatch(/3 specs, 0 failures/)}),it("prints the proper output under a failure scenario.",function(){t(n,[o,a,o],[{description:"The oven",results:function(){return{items_:[{failedCount:2,description:"heats up",items_:[{trace:{stack:"stack trace one\n  second line"}},{trace:{stack:"stack trace two"}}]}]}}},{description:"The washing machine",results:function(){return{items_:[{failedCount:2,description:"washes clothes",items_:[{trace:{stack:"stack trace one"}}]}]}}}],{specs:function(){return[null,null,null]},results:function(){return{items_:[null,null,null],totalCount:7,failedCount:2}}},1e3,1777);var e=i.getOutput();expect(e).toMatch(/^Started/),expect(e).toMatch(/F\.F/),expect(e).toMatch(/The oven heats up\n  stack trace one\n    second line\n  stack trace two/),expect(e).toMatch(/The washing machine washes clothes\n  stack trace one/),expect(e).toMatch(/3 specs, 2 failures/)})}),describe("When a Jasmine environment executes",function(){beforeEach(function(){n.reportRunnerStarting()}),it("should print 'Started' to the console",function(){expect(i.getOutput()).toEqual("Started"+r)}),describe("when a spec reports",function(){beforeEach(function(){i.clear()}),it("prints a green dot if the spec passes",function(){n.reportSpecResults(a),expect(i.getOutput()).toMatch(/\./)}),it("prints a red dot if the spec fails",function(){n.reportSpecResults(o),expect(i.getOutput()).toMatch(/F/)}),it("prints a yellow star if the spec was skipped",function(){n.reportSpecResults(c),expect(i.getOutput()).toMatch(/\*/)})}),describe("when a suite reports",function(){var e;beforeEach(function(){e=function(){return{items_:[]}}}),it("remembers suite results",function(){n.reportSuiteResults({description:"Oven",results:e}),n.reportSuiteResults({description:"Mixer",results:e}),expect(n.suiteResults[0].description).toEqual("Oven"),expect(n.suiteResults[1].description).toEqual("Mixer")}),it("creates a description out of the current suite and any parent suites",function(){var t={description:"My house",results:e},i={description:"kitchen",parentSuite:t,results:e};n.reportSuiteResults({description:"oven",parentSuite:i,results:e}),expect(n.suiteResults[0].description).toEqual("My house kitchen oven")}),it("gathers failing spec results from the suite - the spec must have a description.",function(){n.reportSuiteResults({description:"Oven",results:function(){return{items_:[{failedCount:0,description:"specOne"},{failedCount:99,description:"specTwo"},{failedCount:0,description:"specThree"},{failedCount:88,description:"specFour"},{failedCount:3}]}}}),expect(n.suiteResults[0].failedSpecResults).toEqual([{failedCount:99,description:"specTwo"},{failedCount:88,description:"specFour"}])})}),describe("and finishes",function(){describe("when reporting spec failure information",function(){it("prints suite and spec descriptions together as a sentence",function(){n.suiteResults=[{description:"The oven",failedSpecResults:[{description:"heats up",items_:[]},{description:"cleans itself",items_:[]}]},{description:"The mixer",failedSpecResults:[{description:"blends things together",items_:[]}]}],n.reportRunnerResults(l),expect(i.getOutput()).toContain("The oven heats up"),expect(i.getOutput()).toContain("The oven cleans itself"),expect(i.getOutput()).toContain("The mixer blends things together")}),it("prints stack trace of spec failure",function(){n.suiteResults=[{description:"The oven",failedSpecResults:[{description:"heats up",items_:[{trace:{stack:"stack trace one"}},{trace:{stack:"stack trace two"}}]}]}],n.reportRunnerResults(l),expect(i.getOutput()).toContain("The oven heats up"),expect(i.getOutput()).toContain("stack trace one"),expect(i.getOutput()).toContain("stack trace two")})}),describe("when reporting the execution time",function(){it("prints the full finished message",function(){n.now=function(){return 1e3},n.reportRunnerStarting(),n.now=function(){return 1777},n.reportRunnerResults(l),expect(i.getOutput()).toContain("Finished in 0.777 seconds")}),it("prints round time numbers correctly",function(){function e(e,t){i.clear(),n.runnerStartTime=e,n.now=function(){return t},n.reportRunnerResults(u)}e(1e3,11e3),expect(i.getOutput()).toContain("10 seconds"),e(1e3,2e3),expect(i.getOutput()).toContain("1 seconds"),e(1e3,1100),expect(i.getOutput()).toContain("0.1 seconds"),e(1e3,1010),expect(i.getOutput()).toContain("0.01 seconds"),e(1e3,1001),expect(i.getOutput()).toContain("0.001 seconds")})}),describe("when reporting the results summary",function(){it("prints statistics in green if there were no failures",function(){n.reportRunnerResults({specs:function(){return[null,null,null]},results:function(){return{items_:[null,null,null],totalCount:7,failedCount:0}}}),expect(i.getOutput()).toContain("3 specs, 0 failures")}),it("prints statistics in red if there was a failure",function(){n.reportRunnerResults({specs:function(){return[null,null,null]},results:function(){return{items_:[null,null,null],totalCount:7,failedCount:3}}}),expect(i.getOutput()).toContain("3 specs, 3 failures")}),it("handles pluralization with 1's ones appropriately",function(){n.reportRunnerResults({specs:function(){return[null]},results:function(){return{items_:[null],totalCount:1,failedCount:1}}}),expect(i.getOutput()).toContain("1 spec, 1 failure")})}),describe("done callback",function(){it("calls back when done",function(){expect(s).toBeFalsy(),n.reportRunnerResults({specs:function(){return[null,null,null]},results:function(){return{items_:[null,null,null],totalCount:7,failedCount:0}}}),expect(s).toBeTruthy()})})})})});