define(["require","vendor/core/currpage","vendor/core/renderer","vendor/core/mediator"],function(e,t,n,i){var r,o="|",a=function(e,t,n){this.name="NoFunctionFoundError",this.message=e+": the function #-"+t+"-# probably fails or is not implemented yet. - "+n},s=function(e){function t(){}return t.prototype=e,new t},c=function(e,t){var n;if(t)for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},l=function(e,t){var i,r,o=!1;for(i in t)if(t.hasOwnProperty(i))if(n.isArray(t[i])){if(o=l(e,t[i]))break}else{if(t[i]===e){o=!0;break}for(r in t[i])if(t[i][r]===e){o=!0;break}}return o},d=function(e){this.extend(window,e)},u=function(t){var n,r=function(t){e([t.url],function(e){i.publish(t.eventName,e)})};if(this.isArray(t))for(n=0;t.length>n;n+=1)r(t[n]);else this.isObject(t)&&e([t.url],function(e){i.publish(t.eventName,e)})},p=function(e){this.SYSTEM_ID?(this.extend(e,this.GLOBALFILTERS),this.FILTERS=e):(this.GLOBALFILTERS=e,this.FILTERS=e)},f=function(e,t,n){var o,a;if(this.isArray(r))for(a=0;r.length>a;a+=1)o=r[a],n===o[0]&&b(o[1],e,t,o[0]);i.subscribe(n,function(i){b(i,e,t,n)})},h=function(e){var t;this.extend(this.SYSTEMCONFIG._eventMap,e);for(t in e)e.hasOwnProperty(t)&&this.subscribeEvent(this,this.SYSTEMCONFIG,t)},g=function(e,t,n,i){var r,o,a=!0;for(r=0;e.length>r;r+=1)if(t[e[r]]&&n.isFunction(t[e[r]])&&(o=t[e[r]].call(n,i),a!==o)){a=o;break}return a},m=function(e,t,n){var i,r,o,a,s,c;if(e.isObject(t))for(i in t)t.hasOwnProperty(i)&&(o=i.split("|"),s=[],c=!1,a=!0,o.length>1&&(v(o,s),a=g(s,e.FILTERS,e,n),c=!0),a?c?(r=o.length-1,t[o[r]]=t[i],delete t[i],m(e,t[o[r]],n)):m(e,t[i],n):delete t[i]);return t},v=function(e,t){var n,i,r,o="!render";if(n=e.length,n>1)for(i=0;n-1>i;i+=1)o===e[i]?r=!1:t.push(e[i]);return e[n-1]},y=function(e,t,n,i){var r,s,c,l,d,u,p,f,h,y,b=!0,w=!0,x=e.split("(");if(s=x[0],c=s.split(o),l=x[1]?x[1].slice(0,-1):"",l=l.replace(/\s/g,"").split(","),p=[],f=[],c.length>1&&(s=v(c,p)),p.length>0&&(w=g(p,t.FILTERS,t,i)),t.isArray(l)&&!0===w){for(y=[],r=0;l.length>r;r+=1)h=!0,d=l[r],f=[],u=d.split(o),u.length>1&&(h=v(u,f),d=u[u.length-1]),f.length>0&&(b=g(f,t.FILTERS,t,i)),!0===b&&n.params[d]&&(d=n.params[d],d=m(t,d,i),!0===h&&(d=t.render(d,i)),y.push(d));y.push(i);try{t[s].apply(t,y)}catch(j){throw new a(t.SYSTEM_ID,s,j)}}},b=function(e,t,n,i){var r,o={currpage:t.getCurrpage(),eventObj:e,params:n.params};if(t.isArray(n._eventMap[i]))for(r=0;n._eventMap[i].length>r;r+=1)y(n._eventMap[i][r],t,n,o);else t.isString(n._eventMap[i])?y(n._eventMap[i],t,n,o):t.isFunction(n._eventMap[i])&&n._eventMap[i].apply(t,[o,i])},w=function(e){r=e||[]},x=function(e){this.SYSTEMCONFIG=e};return a.prototype=Error.prototype,{SYSTEM_ID:null,inherit:s,isArray:n.isArray,isFunction:n.isFunction,isString:n.isString,isObject:n.isObject,isAvailable:l,extend:c,render:n.render,loadLibrary:u,setSystemConfig:x,subscribeEvent:f,subscribeExternalEvents:h,handleEvent:b,getCurrpage:t.get,initGlobals:d,setFilters:p,setEventQueue:w}});