define(["require"],function(e){return{init:function(){if(document.getElementById("fedoverlay"))return document.body.removeChild(document.body.lastChild),void 0;var t,n=document,i="cxodev",r={use:null,settings:{}},o=window.localStorage?window.localStorage:n.cookie,a=function(e,t){document.cookie=e+"="+JSON.stringify(t)+"; expires=Mi, 01-Jan-2020 20:00:00 GMT;path=/"},s=function(){var e=n.getElementById("nameid").value;return obj={host:n.getElementById("fedhost").value,port:n.getElementById("fedport").value,offset:n.getElementById("fedoffset").value,styleElmt:n.getElementById("styleElmt").value,styleElmtValue:n.getElementById("styleElmtValue").value},'{"'+e+'":'+JSON.stringify(obj)+"}"},c=function(e){var t=JSON.parse(e.options[e.selectedIndex].value);n.getElementById("nameid").value=e.options[e.selectedIndex].text,n.getElementById("fedhost").value=t.host||"",n.getElementById("fedport").value=t.port||"",n.getElementById("fedoffset").value=t.offset||"",n.getElementById("use").checked=t.use,n.getElementById("styleElmt").value=t.styleElmt,n.getElementById("styleElmtValue").value=t.styleElmtValue},l=function(){var e,t=n.createElement("div"),i="<div class='fedbuttons'>Load Config(s)<br/><input type='text' id='loadFed' class='fedtf'/><button type='button' id='btnLoadFed'>Load Config-JSON</button><br/><a id='feda'>advanced</a><div id='fedtextload'><textarea cols='30' rows='10' id='fedtextarea'></textarea><button type='button' id='btnLaodTFFed'>Load from Textfield</button></div></div><div class='fedbuttons'>Choose Config<br/><button type='button' id='btnQCFed'>Quickchange</button><select id='slct'></select><button type='button' id='btnDelFed'>Delete</button></div><div class='fedbuttons'>Create new Config<table class='fedtable' cellspacing='0' cellpadding='1'><tr><td>Name(ID)*:</td><td><input type='text' id='nameid' class='fedtf'/></td></tr><tr><td>Server*:Port:</td><td><input type='text' id='fedhost' class='fedtf' value='server.cxo.name'/></td><td>:<input type='text' id='fedport' class='fedtf' value='80'/></td></tr><tr><td>Offset:</td><td><input type='text' id='fedoffset' class='fedtf' value='/path/to/src/'/></td></tr><tr><td>Visibility:</td><td><input value='borderTop' type='text' id='styleElmt' class='fedtf'/><td><input value='5px solid red' type='text' id='styleElmtValue' class='fedtf'/></td></tr></table><div id='uselabel'>use this configuration: <input type='checkbox' id='use'/></div><button type='button' id='btnSaveFed'>Save</button><button type='button' id='btnCancelFed'>Cancel</button><button type='button' id='btnCloseFed'>Close & Reload Page</button></div><div id='fedlabel'></div>";t.setAttribute("id","fedoverlay"),n.body.appendChild(t),e=n.createElement("div"),e.setAttribute("id","fedform"),e.innerHTML=i,t.appendChild(e)},d=function(){var e,r,o=n.getElementById("slct"),a=f(i);if(t=n.getElementById("fedlabel"),o.options.length=0,a){u();for(e in a.settings)r=n.createElement("option"),r.text=e,r.style.color=a.use===e?"green":"black",a.settings[e].use=a.use===e?!0:!1,r.value=JSON.stringify(a.settings[e]),o.options.add(r);return o.selectedIndex=-1,m(o.options.length+" Setting(s) found. Active is : "+a.use),!0}return m("No setting(s) found!","warn"),!1},u=function(){n.getElementById("fedtextarea").value=JSON.stringify(f(i).settings)},p=function(e){var t,n=document.cookie.split(";");for(t=0;n.length>t;t++)if(x=n[t].substr(0,n[t].indexOf("=")),y=n[t].substr(n[t].indexOf("=")+1),x=x.replace(/^\s+|\s+$/g,""),x==e)return JSON.parse(unescape(y));return null},f=function(e){return o===window.localStorage?JSON.parse(o.getItem(i)):p(e)},h=function(e,t){o===window.localStorage?o.setItem(e,JSON.stringify(t)):a(e,t)},g=function(e,t){var n;if(t)for(n in t)n&&(e[n]=t[n])},m=function(e,n){t.innerHTML=e,"warn"===n&&(t.style.color="orange"),"error"===n&&(t.style.color="red"),void 0===n&&(t.style.color="green")};if(defaultFedSettings=function(e){var t=f(i);t||(h(i,r),t=f(i)),g(t.settings,e),h(i,t),d()},o){var v,b,w,j,k,_,C,q,E,T,S;e(["./vendor/require-plugins/css!./dev_bookmarklet.css"]),l(),isConfig=d(),v=n.getElementById("slct"),b=n.getElementById("btnSaveFed"),w=n.getElementById("btnCloseFed"),j=n.getElementById("btnLoadFed"),C=n.getElementById("btnDelFed"),q=n.getElementById("btnQCFed"),E=n.getElementById("btnCancelFed"),T=n.getElementById("feda"),k=n.getElementById("btnLaodTFFed"),_=n.getElementById("fedtextload"),v.onchange=function(){c(this)},q.onclick=function(){var e;-1!==v.selectedIndex&&(e=f(i),e.use!==v.options[v.selectedIndex].innerHTML?(e.use=v.options[v.selectedIndex].innerHTML,h(i,e),window.location.reload()):m(e.use+" already used!","warn"))},C.onclick=function(){var e,t;if(-1!==v.selectedIndex){if(t=v.options[v.selectedIndex].innerHTML,!confirm("Delete "+t+"?"))return;e=f(i),e.use===t&&(e.use=null),delete e.settings[t],h(i,e),d(),m(t+" deleted!","warn")}},b.onclick=function(){var e,t=s();f(i)?(e=f(i),n.getElementById("use").checked?e.use=n.getElementById("nameid").value:e.use===n.getElementById("nameid").value&&(e.use=null),g(e.settings,JSON.parse(t)),h(i,e),d(),m("Saved!")):(n.getElementById("use").checked&&(r.use=n.getElementById("nameid").value),g(r.settings,JSON.parse(t)),h(i,r),d(),m("Saved!"))},E.onclick=function(){var e;for(e=0;3>=e;e++)n.body.removeChild(document.getElementById("fedoverlay"))},w.onclick=function(){window.location.reload()},j.onclick=function(){var e,t=n.getElementById("loadFed").value;t&&(e=document.createElement("script"),e.type="text/javascript",e.src=t+"?callback=fedSettings",n.body.appendChild(e))},T.onclick=function(){S?(_.style.visibility="hidden",S=!1):(_.style.visibility="visible",S=!0)},k.onclick=function(){var e,t;try{e=JSON.parse(n.getElementById("fedtextarea").value),t=f(i)?f(i):r,g(t.settings,e),h(i,t),_.style.visibility="hidden",d(),m("Settings added!")}catch(o){m("Can't add settings","error")}}}else alert("use a browser with local storage or enable cookies!")}}});