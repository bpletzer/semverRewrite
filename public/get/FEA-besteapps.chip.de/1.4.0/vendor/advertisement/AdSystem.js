define(["require","jquery","vendor/core/mediator","vendor/core/queue","vendor/core/hashParams"],function(e,t,n,i,r){var o,s=[],a={},c=function(e){return t("[data-adZone]",e)},l=function(e){return e=e||c(),e.map(function(){return this.id})},u=function(e){var t,n,i;for(t=0;e.childNodes.length>t;t++)if(n=e.childNodes[t],i=n.nodeName.toLowerCase(),"script"!=i&&"noscript"!=i&&"#comment"!=i&&!n.style||!n.style.visibility&&"hidden"!=n.style.visibility&&!n.style.display&&"none"!=n.style.display&&"dc_pfad_pixel"!=n.id&&"nix_topbanner"!=n.id&&("a"!=i||!n.children||!n.children[0]||"img"!=n.children[0].nodeName.toLowerCase()||"http://s0.2mdn.net/viewad/817-grey.gif"!=n.children[0].src))return!0;return!1},d=function(e){var t,n,i,r,s=!1,c=e.eventObj,l=c.system.SYSTEM_ZONES;for(t in l)if(l[t].zoneId===c.zoneId&&l[t].chain){n=l[t].chain.shift(),r=l[t];break}if(n){for(i in a)if(a[i].treetool_provider_id===n){g(a[i],o,!0,r),s=!0;break}s||d(e)}},f=function(e,t,n,i){var r,o=t.data.providers,s=[];for(r in o)(o[r].pagetype===i||!0===i)&&o[r].provider===e&&(n&&n[o[r].media]?s.push({zoneId:n[o[r].media],chain:o[r].chain}):s.push({zoneId:o[r].media,chain:o[r].chain}));return s},p=function(){var e=document.createElement("iframe");return e.style.display="none",e},h=function(t){e([t.url],function(e){o=o||e,n.publish(t.eventName)})},m=function(e){var t,n,i,r=o.data.providers;a=e;for(n in r)if(t=r[n].provider,r[n].pagetype===this.pageType)for(i in e)e[i].treetool_provider_id===t&&(e[i].already_req||function(e,t,n){g(e[t],o,n)}(e,i,this.pageType),e[i].already_req=!0)},g=function(t,i,r,o){e(["require",t.system_req_id],function(e,a){var c;a.SYSTEM_ZONES=a.mapZones(t.treetool_provider_id,i,a.zone_map,r),o&&a.SYSTEM_ZONES.push(o),s.push(t.treetool_provider_id),a.setSystemConfig(t);for(c in t._eventMap)a.subscribeEvent(a,t,c);n.publish("system."+t.treetool_provider_id+".init")})},v=function(e){var t,n,i,r;for(t in e)if(this.isString(e[t])){if(e[t]===this.pageTypeId){r=t;break}}else if(this.isArray(e[t]))for(i=e[t],n=0;i.length>n;n+=1)if(i[n]===this.pageTypeId){r=t;break}this.pageType=r},y=function(e){var t=r().adkeyword||r().showroom;t&&(window[e]=t)},b=function(e){this.zone_map=e},x=function(e){this.pageTypeId=e},w=function(e,t){var n,i,r;for(n=document.getElementById(e),r=n.getElementsByTagName("script"),i=r.length;i--;)r[i].parentNode.removeChild(r[i]);document.getElementById(t).appendChild(n),n.style.display=""},k=function(e,t,n,r,o){var s="temp"+e,o=o||"_cxo_ad";document.write('<div id="'+s+'" style="display:none">'),document.write(r),document.write("</div>"),document.write('<script type="text/javascript">window.'+o+" = window."+o+" || [];"+'_cxo_ad.push(["vendor/advertisement/AdSystem", "checkPlaceAd", "'+s+'", "'+e+'"]);'+"</"+"script>"),i.isExisting(o)||i.create(o)};return{getTreeConfig:function(){return o},setHashKeyword:y,placeAd:k,checkPlaceAd:w,hasAdContent:u,setPageTypeIdentifier:x,getZones:c,getZonesIds:l,mapZones:f,iframe:p(),loadAdsystems:m,loadTreetoolConfig:h,setPageType:v,setZoneMap:b,callNextSystem:d}});